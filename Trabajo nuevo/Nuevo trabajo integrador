# -----------------------------
# PRACTICA INTEGRADORA 1 - PYTHON
# -----------------------------

# Lista de golosinas -> cada fila tiene [código, nombre, stock]
golosinas = [
    [1, "KitKat", 20],
    [2, "Chicles", 50],
    [3, "Caramelos de Menta", 50],
    [4, "Huevo Kinder", 10],
    [5, "Chetoos", 10],
    [6, "Twix", 10],
    [7, "M&M'S", 10],
    [8, "Papas Lays", 2],
    [9, "Milkybar", 10],
    [10, "Alfajor Tofi", 11],
    [11, "Lata Coca", 15],
    [12, "Chitos", 20]
]

# Diccionario de empleados -> clave = legajo, valor = nombre
empleados = {
    1100: "José Alonso",
    1200: "Federico Pacheco",
    1300: "Nelson Pereira",
    1400: "Osvaldo Tejada",
    1500: "Gastón Garcia"
}

# Tupla con las claves secretas del técnico
clavesTecnico = ("UTN-FRM", "admin", "CCCDDD")

# Lista vacía para guardar el historial de pedidos
# cada fila será [código, nombre, cantidad pedida]
golosinasPedidas = []

# -----------------------------
# MENÚ PRINCIPAL
# -----------------------------
while True:
    print("\n--- MÁQUINA DE GOLOSINAS ---")
    print("a. Pedir golosina")
    print("b. Mostrar golosinas")
    print("c. Rellenar golosinas (técnico)")
    print("d. Apagar máquina")

    opcion = input("Seleccione una opción: ")

    # ----------------------------------------
    # Opción A: Pedir golosina
    # ----------------------------------------
    if opcion.lower() == "a":
        try:
            # Pedimos el legajo y lo validamos
            legajo = int(input("Ingrese su legajo: "))
        except:
            print("Debe ingresar un número de legajo.")
            continue

        # Si no existe el legajo en empleados
        if legajo not in empleados:
            print("Usted no es un empleado de la empresa.")
        else:
            print(f"Bienvenido {empleados[legajo]}!")  # saludo
            while True:
                try:
                    # Pedimos código de golosina
                    codigo = int(input("Ingrese código de la golosina (o 0 para salir): "))
                except:
                    print("Debe ingresar un número.")
                    continue

                if codigo == 0:  # salir de pedir golosinas
                    break

                encontrado = False  # bandera para ver si el código existe
                for g in golosinas:
                    if g[0] == codigo:
                        encontrado = True
                        if g[2] > 0:  # si hay stock
                            g[2] -= 1  # descontamos una golosina
                            # revisar si ya está en el historial
                            existe = False
                            for pedido in golosinasPedidas:
                                if pedido[0] == codigo:
                                    pedido[2] += 1
                                    existe = True
                                    break
                            if not existe:
                                golosinasPedidas.append([codigo, g[1], 1])
                            print(f"Se entregó {g[1]}. Quedan {g[2]} en stock.")
                        else:
                            # si no hay stock
                            print(f"Lo sentimos, la golosina {g[1]} no se encuentra disponible.")
                            otra = input("Ingrese otra golosina o escriba 'salir' para terminar: ")
                            if otra.lower() == "salir":
                                break
                if not encontrado:
                    print("Código inválido.")

    # 
    # Opción B: Mostrar golosinas
    # 
    elif opcion.lower() == "b":
        print("\n--- LISTA DE GOLOSINAS ---")
        # Mostramos todas las golosinas con stock
        for g in golosinas:
            print(f"Código: {g[0]} | {g[1]} | Stock: {g[2]}")

    # 
    # Opción C: Rellenar golosinas (Técnico)
    # 
    elif opcion.lower() == "c":
        # Pedimos las 3 claves en orden
        clave1 = input("Ingrese clave 1: ")
        clave2 = input("Ingrese clave 2: ")
        clave3 = input("Ingrese clave 3: ")

        # Comprobamos si son correctas
        if (clave1, clave2, clave3) == clavesTecnico:
            try:
                codigo = int(input("Ingrese el código de la golosina a recargar: "))
            except:
                print("Debe ingresar un número válido.")
                continue

            encontrado = False
            for g in golosinas:
                if g[0] == codigo:
                    encontrado = True
                    try:
                        cantidad = int(input("Ingrese cantidad a recargar: "))
                    except:
                        print("Debe ingresar un número válido.")
                        break
                    if cantidad > 0:
                        g[2] += cantidad
                        print(f"Se recargó {cantidad} unidades de {g[1]}. Stock actual: {g[2]}")
                    else:
                        print("La cantidad debe ser mayor a 0.")
            if not encontrado:
                print("Código inválido.")
        else:
            print("No tiene permiso para ejecutar la función de recarga.")

    # 
    # Opción D: Apagar máquina
    # 
    elif opcion.lower() == "d":
        print("\n--- HISTORIAL DE GOLOSINAS PEDIDAS ---")
        total = 0
        for p in golosinasPedidas:
            print(f"{p[1]} (código {p[0]}): {p[2]} unidades")
            total += p[2]
        print(f"\nTotal de golosinas pedidas: {total}")
        print("Apagando máquina... ¡Hasta luego!")
        break

    # Si se elige una opción no válida
    else:
        print("Opción no válida. Intente de nuevo.")
        #Final lo mejor de esto es mantener el orden y partir bien y entender bien q se pide en cada parte separarlas y 
        # tener un orden mental de las cosas los diccionarios importantisimos prolijidad y orden por q una mala tecla
        #palabra o algo mas y se va todo y no funciona absolutamente nada , los bucles importantisimo tambine saber ordenar con qpaso
        # y qcosa va a analizary en q momento
